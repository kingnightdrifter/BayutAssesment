package com.bayut.bayutassignemnt.viewimport android.content.Intentimport android.os.Bundleimport androidx.lifecycle.ViewModelProviderimport androidx.recyclerview.widget.GridLayoutManagerimport com.bayut.bayutassignemnt.Rimport com.bayut.bayutassignemnt.app.ConstantValuesimport com.bayut.bayutassignemnt.databinding.ActivityMainBindingimport com.bayut.bayutassignemnt.databinding.RowItemPostBindingimport com.bayut.bayutassignemnt.interfaces.OnGlideListenerimport com.bayut.bayutassignemnt.model.Resultimport com.bayut.bayutassignemnt.utils.GlideAppimport com.bayut.bayutassignemnt.utils.GridSpacingItemDecorationimport com.bayut.bayutassignemnt.view.adapter.GenericAdapterimport com.bayut.bayutassignemnt.viewmodel.MainActivityViewModelimport com.katch.hi5.data.api.ResourceObserverimport com.katch.hi5.data.api.ToastMessageErrorViewclass MainActivity : BaseActivity() {    lateinit var binding : ActivityMainBinding    lateinit var viewModel : MainActivityViewModel    lateinit var genericAdapter:  GenericAdapter<Result, RowItemPostBinding>    lateinit var listData : ArrayList<Result>    lateinit var loadPhotoGlideModule: GlideApp    var spanCount = 2 // 2 columns    var spacing = 14    var itemDecoration: GridSpacingItemDecoration? = null    override fun onCreate(savedInstanceState: Bundle?) {        super.onCreate(savedInstanceState)        listData = ArrayList()        binding = ActivityMainBinding.inflate(layoutInflater)        setContentView(binding.root)        viewModel = ViewModelProvider(this).get(MainActivityViewModel::class.java)        loadPhotoGlideModule = GlideApp(this)        // Grid item spacing        // Grid item spacing        itemDecoration =            GridSpacingItemDecoration(spanCount, spacing, true)        initData()        requestData()        showOrHideProgressBar(viewModel)    }    private fun initData(){        genericAdapter = object : GenericAdapter<Result, RowItemPostBinding>(this, listData){            override fun getLayoutResId(): Int {                return R.layout.row_item_post            }            override fun onBindData(                model: Result?,                position: Int,                dataBinding: RowItemPostBinding            ) {                dataBinding.txtName.text = "Name : "+model?.name                dataBinding.txtPrice.text =  "Price : "+model?.price                model?.imageUrls?.get(0)?.let { loadPhotoGlideModule.loadImageFromPath(it,dataBinding.image) }            }            override fun onItemClick(model: Result?, position: Int) {                startActivity( Intent(this@MainActivity,FullScreenPreviewActivity::class.java).apply {                    putExtra(MainActivity::class.java.simpleName, model);                })            }        }        binding.recyclerView.setLayoutManager(GridLayoutManager(this, 2))        // Grid item spacing        // Grid item spacing        itemDecoration?.let { binding.recyclerView.removeItemDecoration(it) }        itemDecoration?.let { binding.recyclerView.addItemDecoration(it) }        binding.recyclerView.invalidate()        binding.recyclerView.adapter = genericAdapter    }    private fun requestData(){        viewModel.getItemsRequest()        viewModel.getList()?.observe(this, ResourceObserver.decorateWithErrorHandling({            listData.addAll(it.results)            genericAdapter.notifyDataSetChanged()        }, ToastMessageErrorView(this)))    }}